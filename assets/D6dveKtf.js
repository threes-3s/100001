import{Z as $,j as z,ad as r,$ as c,p as m,q as C,D as i,a1 as t,a0 as l,a3 as D,W as x,a2 as E,E as S,ae as T,a9 as B,aa as M}from"./app-Cyw_FY8K.js";import{h as I,E as V}from"./BIeF07JP.js";import{m as g,c as u,M as G}from"./Duri_qzO.js";import"./CXEywoEX.js";const N="data:image/svg+xml,%3c?xml%20version='1.0'%20standalone='no'?%3e%3c!DOCTYPE%20svg%20PUBLIC%20'-//W3C//DTD%20SVG%201.1//EN'%20'http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd'%3e%3csvg%20t='1756468854925'%20class='icon'%20viewBox='0%200%201126%201024'%20version='1.1'%20xmlns='http://www.w3.org/2000/svg'%20p-id='10400'%20xmlns:xlink='http://www.w3.org/1999/xlink'%20width='219.921875'%20height='200'%3e%3cpath%20d='M384%20640m-384%200a384%20384%200%201%200%20768%200%20384%20384%200%201%200-768%200Z'%20fill='%23DFF5E3'%20p-id='10401'%3e%3c/path%3e%3cpath%20d='M878.08%20657.92c-10.24-10.24-10.24-25.6%200-35.84%2010.24-10.24%2025.6-10.24%2035.84%200l181.76%20181.76c10.24%2010.24%2010.24%2025.6%200%2035.84-10.24%2010.24-25.6%2010.24-35.84%200l-181.76-181.76z'%20fill='%23333333'%20p-id='10402'%3e%3c/path%3e%3cpath%20d='M348.16%20632.32c-10.24-10.24-7.68-28.16%202.56-35.84%2010.24-10.24%2028.16-7.68%2035.84%202.56%2064%2074.24%20153.6%20117.76%20253.44%20117.76%20184.32%200%20332.8-148.48%20332.8-332.8S824.32%2051.2%20640%2051.2c-97.28%200-189.44%2043.52-250.88%20115.2-10.24%2010.24-25.6%2012.8-35.84%202.56-10.24-10.24-12.8-25.6-2.56-35.84C422.4%2048.64%20527.36%200%20640%200c212.48%200%20384%20171.52%20384%20384s-171.52%20384-384%20384c-112.64%200-220.16-48.64-291.84-135.68z'%20fill='%23333333'%20p-id='10403'%3e%3c/path%3e%3cpath%20d='M401.92%20348.16l-92.16%20140.8H128c-15.36%200-25.6-10.24-25.6-25.6s10.24-25.6%2025.6-25.6h153.6l120.32-189.44%2097.28%20166.4%2058.88-84.48%2066.56%20130.56%2084.48-284.16%20115.2%20140.8c10.24%2010.24%207.68%2028.16-2.56%2035.84-10.24%2010.24-28.16%207.68-35.84-2.56l-53.76-66.56L640%20599.04l-84.48-168.96-58.88%2081.92-94.72-163.84z'%20fill='%233CC451'%20p-id='10404'%3e%3c/path%3e%3c/svg%3e",O=z({setup(){},data(){return{price:"6.6",step:"quiz",loading:!1,limit:6,page:1,backdoor:{isTrial:!1,timestamp:new Date().getTime(),count:0},questions:r.getAll(),gender:r.getGender()||""}},methods:{createRandomAnswers(){const e=[-3,-2,-1,0,1,2,3];this.questions.forEach(s=>{const o=Math.floor(Math.random()*7);s.answer=e[o]})},async analysis(e,s=!1){let o="https://s.one-quant.com/mbti/analysis";s&&(o="https://walle-quant-website-2cg83b3402af-1256154226.ap-shanghai.app.tcloudbase.com/mbti/analysis"),this.$route.query.random!==void 0&&this.createRandomAnswers(),this.$route.query.host!==void 0&&(o=this.$route.query.host||"/host/analysis"),this.$route.query.proxy!==void 0&&(o=this.$route.query.proxy||"/s/mbti/analysis");const a=await(await fetch(o,{method:"POST",mode:"cors",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)})).json();if(a&&a.code)throw a.message?a.code:a;return a},handlerBackdoor(){const s=new Date().getTime();s-this.backdoor.timestamp<1e3?(this.backdoor.count++,this.backdoor.count>=3&&(g({message:"🎉 恭喜获得一次免费体验彩蛋"}),this.backdoor.isTrial=!0,this.backdoor.timestamp=s,this.backdoor.isTrial&&r.setOrder({total_fee:(this.price*100).toFixed()}))):this.backdoor.timestamp=s},setGender(){r.setGender(this.gender)},async submit(){try{this.loading=!0;let e;try{if(e=await this.analysis(this.questions),!(e&&e.type))throw"Unexpected Request Exception"}catch{if(e=await this.analysis(this.questions,!0),!(e&&e.type))throw"Unexpected Request Exception"}await u.load(),u.user.hasLoginState()||await u.user.login(),e.uid=u.user.uid(),e.timestamp=I().format("YYYYMMDDHHmmss"),r.setTraits(e),this.backdoor.isTrial&&r.setOrder({total_fee:(this.price*100).toFixed()}),this.$router.push("/result")}catch(e){this.loading=!1,JSON.stringify(e)==="{}"&&(e="网络异常 请切换网络或稍后重试"),G.error({message:"Error - "+JSON.stringify(e).toUpperCase()}),window.__WALLE_GUARD.sendSecurityReport("mbti|analysis",JSON.stringify(e).toUpperCase()),console.warn(e)}},reset(){r.reset(),this.$refs.quizs.reset()},check(){let e=!0;const s=this.$refs.quizs.curGroupQestions();for(let o of s)if(o.answer===""||o.answer===null){e=!1,this.$refs.quizs.scrollIntoQuestion(o);break}return e||g({message:"请回答完成此组问题！"}),e},next(){if(this.$route.query.submit!==void 0)return this.submit();if(this.check()){if(this.page===this.$refs.quizs.maxPage()){this.submit();return}this.page===this.$refs.quizs.maxPage()-1&&(this.step="submit"),this.$refs.quizs.$el.scrollIntoView({behavior:"smooth"}),this.$refs.quizs.nextPage()}}}}),d=e=>(B("data-v-a99cb95c"),e=e(),M(),e),R={class:"test"},U={class:"content"},A=d(()=>t("h6",null,"做你自己 诚实回答 找出你的性格类型",-1)),L=d(()=>t("span",{class:"next-page"}," 重置回答 ",-1)),P={class:"next-page"},Y=d(()=>t("img",{src:N,width:"150"},null,-1)),j=d(()=>t("br",null,null,-1)),F=d(()=>t("br",null,null,-1)),J={style:{display:"flex","justify-content":"center",color:"#88619a"}},H=d(()=>t("span",{style:{"font-size":"18px","font-weight":"bold"}},"正在分析中 请稍候 ...",-1)),W=d(()=>t("br",null,null,-1));function Q(e,s,o,f,a,Z){const b=c("ui-header"),_=c("ui-container"),w=c("ui-quizs"),y=c("Delete"),p=S,h=T,q=c("ArrowRightBold"),k=c("Loading"),v=V;return m(),C("main",null,[i(b),t("div",R,[i(_,{class:"container",background:"#d6ece3"},{content:l(()=>[t("div",U,[t("h3",{onClick:s[0]||(s[0]=(...n)=>e.handlerBackdoor&&e.handlerBackdoor(...n))},"MBTI 性格测试"),A])]),_:1}),i(w,{disabled:e.loading,ref:"quizs",class:"quizs",questions:e.questions,limit:e.limit,page:e.page,"onUpdate:page":s[1]||(s[1]=n=>e.page=n)},null,8,["disabled","questions","limit","page"]),e.page===1?(m(),D(h,{key:0,color:"#88619a",class:"button mbti-reset mbti-submit",round:"",loading:e.loading,onClick:s[2]||(s[2]=n=>e.reset()),size:"large"},{default:l(()=>[L,i(p,null,{default:l(()=>[i(y)]),_:1})]),_:1},8,["loading"])):x("",!0),i(h,{color:"#88619a",class:"button mbti-submit",round:"",loading:e.loading,onClick:s[3]||(s[3]=n=>e.next()),size:"large"},{default:l(()=>[t("span",P,E(e.step==="submit"?"查看结果":"下一组"),1),i(p,null,{default:l(()=>[i(q)]),_:1})]),_:1},8,["loading"]),i(v,{class:"mbti-submit-dialog","modal-class":"mbti-submit-modal",modelValue:e.loading,"onUpdate:modelValue":s[4]||(s[4]=n=>e.loading=n),"show-close":!1,"close-on-click-modal":!1,"close-on-press-escape":!1,width:"500"},{default:l(()=>[Y,j,F,t("h3",J,[i(p,{class:"is-loading",size:"30",style:{"margin-right":"10px"}},{default:l(()=>[i(k)]),_:1}),H]),W]),_:1},8,["modelValue"])])])}const te=$(O,[["render",Q],["__scopeId","data-v-a99cb95c"]]);export{te as default};
