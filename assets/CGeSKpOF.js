import{c as k,b as Fe,u as w,h as O,e as ke}from"./DIgKSzXd.js";var x=function(s,n,t,u){function i(e){return e instanceof t?e:new t(function(o){o(e)})}return new(t||(t=Promise))(function(e,o){function c(a){try{r(u.next(a))}catch(d){o(d)}}function h(a){try{r(u.throw(a))}catch(d){o(d)}}function r(a){a.done?e(a.value):i(a.value).then(c,h)}r((u=u.apply(s,n||[])).next())})},q=function(s,n){var t={label:0,sent:function(){if(e[0]&1)throw e[1];return e[1]},trys:[],ops:[]},u,i,e,o;return o={next:c(0),throw:c(1),return:c(2)},typeof Symbol=="function"&&(o[Symbol.iterator]=function(){return this}),o;function c(r){return function(a){return h([r,a])}}function h(r){if(u)throw new TypeError("Generator is already executing.");for(;t;)try{if(u=1,i&&(e=r[0]&2?i.return:r[0]?i.throw||((e=i.return)&&e.call(i),0):i.next)&&!(e=e.call(i,r[1])).done)return e;switch(i=0,e&&(r=[r[0]&2,e.value]),r[0]){case 0:case 1:e=r;break;case 4:return t.label++,{value:r[1],done:!1};case 5:t.label++,i=r[1],r=[0];continue;case 7:r=t.ops.pop(),t.trys.pop();continue;default:if(e=t.trys,!(e=e.length>0&&e[e.length-1])&&(r[0]===6||r[0]===2)){t=0;continue}if(r[0]===3&&(!e||r[1]>e[0]&&r[1]<e[3])){t.label=r[1];break}if(r[0]===6&&t.label<e[1]){t.label=e[1],e=r;break}if(e&&t.label<e[2]){t.label=e[2],t.ops.push(r);break}e[2]&&t.ops.pop(),t.trys.pop();continue}r=n.call(s,t)}catch(a){r=[6,a],i=0}finally{u=e=0}if(r[0]&5)throw r[1];return{value:r[0]?r[1]:void 0,done:!0}}},L=function(){function s(n){this._config=n,this._cache=n.cache,this._request=n.request}return s.prototype.checkLocalLoginState=function(){return x(this,void 0,void 0,function(){var n,t,u,i,e,o;return q(this,function(c){switch(c.label){case 0:return n=this._cache.keys,t=n.accessTokenKey,u=n.accessTokenExpireKey,[4,this._cache.getStoreAsync(t)];case 1:return i=c.sent(),[4,this._cache.getStoreAsync(u)];case 2:return e=c.sent(),i?e&&e>Date.now()?(o=new B({envId:this._config.env,cache:this._cache,request:this._request}),[4,o.checkLocalStateAsync()]):[3,4]:[3,7];case 3:return c.sent(),[2,o];case 4:return[4,this._cache.removeStoreAsync(t)];case 5:return c.sent(),[4,this._cache.removeStoreAsync(u)];case 6:c.sent(),c.label=7;case 7:return[2]}})})},s.prototype.setRefreshToken=function(n){return x(this,void 0,void 0,function(){var t,u,i,e;return q(this,function(o){switch(o.label){case 0:return t=this._cache.keys,u=t.accessTokenKey,i=t.accessTokenExpireKey,e=t.refreshTokenKey,[4,this._cache.removeStoreAsync(u)];case 1:return o.sent(),[4,this._cache.removeStoreAsync(i)];case 2:return o.sent(),[4,this._cache.setStoreAsync(e,n)];case 3:return o.sent(),[2]}})})},s.prototype.setAccessToken=function(n,t){return x(this,void 0,void 0,function(){var u,i,e;return q(this,function(o){switch(o.label){case 0:return u=this._cache.keys,i=u.accessTokenKey,e=u.accessTokenExpireKey,[4,this._cache.setStoreAsync(i,n)];case 1:return o.sent(),[4,this._cache.setStoreAsync(e,t)];case 2:return o.sent(),[2]}})})},s.prototype.refreshUserInfo=function(){return x(this,void 0,void 0,function(){var n,t;return q(this,function(u){switch(u.label){case 0:return n="auth.getUserInfo",[4,this._request.send(n,{})];case 1:return t=u.sent().data,[4,this.setLocalUserInfo(t)];case 2:return u.sent(),[2,t]}})})},s.prototype.setLocalUserInfo=function(n){return x(this,void 0,void 0,function(){var t;return q(this,function(u){switch(u.label){case 0:return t=this._cache.keys.userInfoKey,[4,this._cache.setStoreAsync(t,n)];case 1:return u.sent(),[2]}})})},s}(),v;(function(s){s.ANONYMOUS="ANONYMOUS",s.WECHAT="WECHAT",s.WECHAT_PUBLIC="WECHAT-PUBLIC",s.WECHAT_OPEN="WECHAT-OPEN",s.CUSTOM="CUSTOM",s.EMAIL="EMAIL",s.USERNAME="USERNAME",s.NULL="NULL",s.PHONE="PHONE"})(v||(v={}));var Pe=function(){var s=function(n,t){return s=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(u,i){u.__proto__=i}||function(u,i){for(var e in i)i.hasOwnProperty(e)&&(u[e]=i[e])},s(n,t)};return function(n,t){s(n,t);function u(){this.constructor=n}n.prototype=t===null?Object.create(t):(u.prototype=t.prototype,new u)}}(),z=function(s,n,t,u){var i=arguments.length,e=i<3?n:u===null?u=Object.getOwnPropertyDescriptor(n,t):u,o;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")e=Reflect.decorate(s,n,t,u);else for(var c=s.length-1;c>=0;c--)(o=s[c])&&(e=(i<3?o(e):i>3?o(n,t,e):o(n,t))||e);return i>3&&e&&Object.defineProperty(n,t,e),e},b=function(s,n){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(s,n)},R=function(s,n,t,u){function i(e){return e instanceof t?e:new t(function(o){o(e)})}return new(t||(t=Promise))(function(e,o){function c(a){try{r(u.next(a))}catch(d){o(d)}}function h(a){try{r(u.throw(a))}catch(d){o(d)}}function r(a){a.done?e(a.value):i(a.value).then(c,h)}r((u=u.apply(s,n||[])).next())})},C=function(s,n){var t={label:0,sent:function(){if(e[0]&1)throw e[1];return e[1]},trys:[],ops:[]},u,i,e,o;return o={next:c(0),throw:c(1),return:c(2)},typeof Symbol=="function"&&(o[Symbol.iterator]=function(){return this}),o;function c(r){return function(a){return h([r,a])}}function h(r){if(u)throw new TypeError("Generator is already executing.");for(;t;)try{if(u=1,i&&(e=r[0]&2?i.return:r[0]?i.throw||((e=i.return)&&e.call(i),0):i.next)&&!(e=e.call(i,r[1])).done)return e;switch(i=0,e&&(r=[r[0]&2,e.value]),r[0]){case 0:case 1:e=r;break;case 4:return t.label++,{value:r[1],done:!1};case 5:t.label++,i=r[1],r=[0];continue;case 7:r=t.ops.pop(),t.trys.pop();continue;default:if(e=t.trys,!(e=e.length>0&&e[e.length-1])&&(r[0]===6||r[0]===2)){t=0;continue}if(r[0]===3&&(!e||r[1]>e[0]&&r[1]<e[3])){t.label=r[1];break}if(r[0]===6&&t.label<e[1]){t.label=e[1],e=r;break}if(e&&t.label<e[2]){t.label=e[2],t.ops.push(r);break}e[2]&&t.ops.pop(),t.trys.pop();continue}r=n.call(s,t)}catch(a){r=[6,a],i=0}finally{u=e=0}if(r[0]&5)throw r[1];return{value:r[0]?r[1]:void 0,done:!0}}},Z=k.getSdkName,Y=k.ERRORS,ee=k.COMMUNITY_SITE_URL,Ae=Fe.RUNTIME,be=w.getQuery,Ue=w.getHash,me=w.removeParam,Oe=w.printWarn,te=O.catchErrorsDecorator,Re=function(s){Pe(n,s);function n(t,u,i,e){var o=s.call(this,t)||this;return o._runtime=t.runtime,o._appid=u,o._scope=i,o._state=e||"weixin",o}return n.prototype.signIn=function(){return R(this,void 0,void 0,function(){return C(this,function(t){return[2,Oe(Y.OPERATION_FAIL,"API signIn has been deprecated, please use signInWithRedirect insteed")]})})},n.prototype.signInWithRedirect=function(){return R(this,void 0,void 0,function(){return C(this,function(t){return[2,this._redirect()]})})},n.prototype.getRedirectResult=function(t){return R(this,void 0,void 0,function(){var u;return C(this,function(i){return u=Ie(),u?[2,this._signInWithCode(u,t)]:[2,null]})})},n.prototype.getLinkRedirectResult=function(t){return t===void 0&&(t={}),R(this,void 0,void 0,function(){var u,i,e,o,c,h;return C(this,function(r){return u=t.withUnionId,i=u===void 0?!1:u,e=Ie(),e?(o=this._appid,c=function(a){switch(a){case"snsapi_login":return"WECHAT-OPEN";default:return"WECHAT-PUBLIC"}}(this._scope),h=this._runtime===Ae.WX_MP?"1":"0",[2,this._request.send("auth.linkWithWeixinCode",{payload:{appid:o,loginType:c,code:e,hybridMiniapp:h,withUnionId:i}})]):[2,null]})})},n.prototype._redirect=function(){var t=me("code",location.href);t=me("state",t),t=encodeURIComponent(t);var u="//open.weixin.qq.com/connect/oauth2/authorize";this._scope==="snsapi_login"&&(u="//open.weixin.qq.com/connect/qrconnect");try{location.href=u+"?appid="+this._appid+"&redirect_uri="+t+"&response_type=code&scope="+this._scope+"&state="+this._state+"#wechat_redirect"}catch(i){throw new Error("["+Z()+"]["+Y.UNKOWN_ERROR+"]"+i)}},n.prototype._signInWithCode=function(t,u){return R(this,void 0,void 0,function(){var i,e,o,c,h,r,a,d;return C(this,function(p){switch(p.label){case 0:return i=this._cache.keys,e=i.accessTokenKey,o=i.accessTokenExpireKey,c=i.refreshTokenKey,h=function(S){switch(S){case"snsapi_login":return"WECHAT-OPEN";default:return"WECHAT-PUBLIC"}}(this._scope),[4,this._getRefreshTokenByWXCode(this._appid,h,t,u)];case 1:return r=p.sent(),a=r.refreshToken,[4,this._cache.setStoreAsync(c,a)];case 2:return p.sent(),r.accessToken?[4,this._cache.setStoreAsync(e,r.accessToken)]:[3,4];case 3:p.sent(),p.label=4;case 4:return r.accessTokenExpire?[4,this._cache.setStoreAsync(o,String(r.accessTokenExpire+Date.now()))]:[3,6];case 5:p.sent(),p.label=6;case 6:return _.fire(E.LOGIN_STATE_CHANGED),_.fire(E.LOGIN_TYPE_CHANGED,{env:this._config.env,loginType:v.WECHAT,persistence:this._config.persistence}),[4,this.refreshUserInfo()];case 7:return p.sent(),d=new B({envId:this._config.env,cache:this._cache,request:this._request}),[4,d.checkLocalStateAsync()];case 8:return p.sent(),[2,d]}})})},n.prototype._getRefreshTokenByWXCode=function(t,u,i,e){return e===void 0&&(e={}),R(this,void 0,void 0,function(){var o,c,h,r,a,d,p;return C(this,function(S){return o=e.withUnionId,c=o===void 0?!1:o,h=e.createUser,r=h===void 0?!0:h,a=this._scope==="snsapi_base"?!1:e.syncUserInfo||!1,d="auth.signIn",p=this._runtime===Ae.WX_MP?"1":"0",[2,this._request.send(d,{appid:t,loginType:u,hybridMiniapp:p,syncUserInfo:a,loginCredential:i,withUnionId:c,createUser:r}).then(function(P){if(P.code)throw new Error("["+Z()+"]["+Y.OPERATION_FAIL+"] failed login via wechat: "+P.code);if(P.refresh_token)return{refreshToken:P.refresh_token,accessToken:P.access_token,accessTokenExpire:P.access_token_expire};throw new Error("["+Z()+"]["+Y.OPERATION_FAIL+"] action:getJwt not return refreshToken")})]})})},z([te({title:"跳转微信公众号授权失败",messages:["请确认以下各项：","  1 - 调用 auth().weixinAuthProvider().signInWithRedirect() 的语法或参数是否正确","如果问题依然存在，建议到官方问答社区提问或寻找帮助："+ee]}),b("design:type",Function),b("design:paramtypes",[]),b("design:returntype",Promise)],n.prototype,"signInWithRedirect",null),z([te({title:"微信公众号登录失败",messages:["请确认以下各项：","  1 - 调用 auth().weixinAuthProvider().getRedirectResult() 的语法或参数是否正确","  2 - 当前环境是否开通了微信公众号登录授权","  3 - 微信公众号的 AppId 与 AppSecret 配置是否正确","如果问题依然存在，建议到官方问答社区提问或寻找帮助："+ee]}),b("design:type",Function),b("design:paramtypes",[Object]),b("design:returntype",Promise)],n.prototype,"getRedirectResult",null),z([te({title:"获取微信重定向绑定结果",messages:["请确认以下各项：","  1 - 调用 auth().weixinAuthProvider().getLinkRedirectResult() 的语法或参数是否正确","  2 - 当前环境是否开通了微信公众号登录授权","  3 - 微信公众号的 AppId 与 AppSecret 配置是否正确","如果问题依然存在，建议到官方问答社区提问或寻找帮助："+ee]}),b("design:type",Function),b("design:paramtypes",[Object]),b("design:returntype",Promise)],n.prototype,"getLinkRedirectResult",null),n}(L);function Ie(){return be("code")||Ue("code")}var Ce=function(){var s=function(n,t){return s=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(u,i){u.__proto__=i}||function(u,i){for(var e in i)i.hasOwnProperty(e)&&(u[e]=i[e])},s(n,t)};return function(n,t){s(n,t);function u(){this.constructor=n}n.prototype=t===null?Object.create(t):(u.prototype=t.prototype,new u)}}(),Ne=function(s,n,t,u){var i=arguments.length,e=i<3?n:u===null?u=Object.getOwnPropertyDescriptor(n,t):u,o;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")e=Reflect.decorate(s,n,t,u);else for(var c=s.length-1;c>=0;c--)(o=s[c])&&(e=(i<3?o(e):i>3?o(n,t,e):o(n,t))||e);return i>3&&e&&Object.defineProperty(n,t,e),e},ne=function(s,n){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(s,n)},K=function(s,n,t,u){function i(e){return e instanceof t?e:new t(function(o){o(e)})}return new(t||(t=Promise))(function(e,o){function c(a){try{r(u.next(a))}catch(d){o(d)}}function h(a){try{r(u.throw(a))}catch(d){o(d)}}function r(a){a.done?e(a.value):i(a.value).then(c,h)}r((u=u.apply(s,n||[])).next())})},M=function(s,n){var t={label:0,sent:function(){if(e[0]&1)throw e[1];return e[1]},trys:[],ops:[]},u,i,e,o;return o={next:c(0),throw:c(1),return:c(2)},typeof Symbol=="function"&&(o[Symbol.iterator]=function(){return this}),o;function c(r){return function(a){return h([r,a])}}function h(r){if(u)throw new TypeError("Generator is already executing.");for(;t;)try{if(u=1,i&&(e=r[0]&2?i.return:r[0]?i.throw||((e=i.return)&&e.call(i),0):i.next)&&!(e=e.call(i,r[1])).done)return e;switch(i=0,e&&(r=[r[0]&2,e.value]),r[0]){case 0:case 1:e=r;break;case 4:return t.label++,{value:r[1],done:!1};case 5:t.label++,i=r[1],r=[0];continue;case 7:r=t.ops.pop(),t.trys.pop();continue;default:if(e=t.trys,!(e=e.length>0&&e[e.length-1])&&(r[0]===6||r[0]===2)){t=0;continue}if(r[0]===3&&(!e||r[1]>e[0]&&r[1]<e[3])){t.label=r[1];break}if(r[0]===6&&t.label<e[1]){t.label=e[1],e=r;break}if(e&&t.label<e[2]){t.label=e[2],t.ops.push(r);break}e[2]&&t.ops.pop(),t.trys.pop();continue}r=n.call(s,t)}catch(a){r=[6,a],i=0}finally{u=e=0}if(r[0]&5)throw r[1];return{value:r[0]?r[1]:void 0,done:!0}}},re=k.ERRORS,Le=k.COMMUNITY_SITE_URL,Te=w.throwError,De=w.isString,xe=ke.addEventListener,qe=O.catchErrorsDecorator,Ke=function(s){Ce(n,s);function n(t){var u=s.call(this,t)||this;return u._onConverted=u._onConverted.bind(u),xe(E.ANONYMOUS_CONVERTED,u._onConverted),u}return n.prototype.signIn=function(){return K(this,void 0,void 0,function(){var t,u,i,e,o,c,h;return M(this,function(r){switch(r.label){case 0:return[4,this._cache.updatePersistenceAsync("local")];case 1:return r.sent(),t=this._cache.keys,u=t.anonymousUuidKey,i=t.refreshTokenKey,[4,this._cache.getStoreAsync(u)];case 2:return e=r.sent(),[4,this._cache.getStoreAsync(i)];case 3:return o=r.sent(),[4,this._request.send("auth.signInAnonymously",{anonymous_uuid:e,refresh_token:o})];case 4:return c=r.sent(),c.uuid&&c.refresh_token?[4,this._setAnonymousUUID(c.uuid)]:[3,10];case 5:return r.sent(),[4,this.setRefreshToken(c.refresh_token)];case 6:return r.sent(),[4,this._request.refreshAccessToken()];case 7:return r.sent(),_.fire(E.LOGIN_TYPE_CHANGED,{env:this._config.env,loginType:v.ANONYMOUS,persistence:"local"}),_.fire(E.LOGIN_STATE_CHANGED),h=new B({envId:this._config.env,cache:this._cache,request:this._request}),[4,h.checkLocalStateAsync()];case 8:return r.sent(),[4,h.user.refresh()];case 9:return r.sent(),[2,h];case 10:throw new Error(JSON.stringify({code:re.OPERATION_FAIL,msg:JSON.stringify(c)||"anonymous signIn failed"}))}})})},n.prototype.linkAndRetrieveDataWithTicket=function(t){return K(this,void 0,void 0,function(){var u,i,e,o,c,h,r;return M(this,function(a){switch(a.label){case 0:return De(t)||Te(re.INVALID_PARAMS,"ticket must be a string"),u=this._cache.keys,i=u.anonymousUuidKey,e=u.refreshTokenKey,[4,this._cache.getStoreAsync(i)];case 1:return o=a.sent(),[4,this._cache.getStoreAsync(e)];case 2:return c=a.sent(),[4,this._request.send("auth.linkAndRetrieveDataWithTicket",{anonymous_uuid:o,refresh_token:c,ticket:t})];case 3:return h=a.sent(),h.refresh_token?[4,this._clearAnonymousUUID()]:[3,8];case 4:return a.sent(),[4,this.setRefreshToken(h.refresh_token)];case 5:return a.sent(),[4,this._request.refreshAccessToken()];case 6:return a.sent(),_.fire(E.ANONYMOUS_CONVERTED,{env:this._config.env}),_.fire(E.LOGIN_TYPE_CHANGED,{loginType:v.CUSTOM,persistence:"local"}),r=new B({envId:this._config.env,cache:this._cache,request:this._request}),[4,r.checkLocalStateAsync()];case 7:return a.sent(),[2,r];case 8:Te(re.OPERATION_FAIL,JSON.stringify(h)||"linkAndRetrieveDataWithTicket failed"),a.label=9;case 9:return[2]}})})},n.prototype._setAnonymousUUID=function(t){return K(this,void 0,void 0,function(){var u,i,e;return M(this,function(o){switch(o.label){case 0:return u=this._cache.keys,i=u.anonymousUuidKey,e=u.loginTypeKey,[4,this._cache.removeStoreAsync(i)];case 1:return o.sent(),[4,this._cache.setStoreAsync(i,t)];case 2:return o.sent(),[4,this._cache.setStoreAsync(e,v.ANONYMOUS)];case 3:return o.sent(),[2]}})})},n.prototype._clearAnonymousUUID=function(){return K(this,void 0,void 0,function(){return M(this,function(t){switch(t.label){case 0:return[4,this._cache.removeStoreAsync(this._cache.keys.anonymousUuidKey)];case 1:return t.sent(),[2]}})})},n.prototype._onConverted=function(t){return K(this,void 0,void 0,function(){var u;return M(this,function(i){switch(i.label){case 0:return u=t.data.env,u!==this._config.env?[2]:[4,this._cache.updatePersistenceAsync(this._config.persistence)];case 1:return i.sent(),[2]}})})},Ne([qe({title:"匿名登录失败",messages:["请确认以下各项：","  1 - 当前环境是否开启了匿名登录","  2 - 调用 auth().anonymouseProvider().signIn() 的语法或参数是否正确","如果问题依然存在，建议到官方问答社区提问或寻找帮助："+Le]}),ne("design:type",Function),ne("design:paramtypes",[]),ne("design:returntype",Promise)],n.prototype,"signIn",null),n}(L),Me=function(){var s=function(n,t){return s=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(u,i){u.__proto__=i}||function(u,i){for(var e in i)i.hasOwnProperty(e)&&(u[e]=i[e])},s(n,t)};return function(n,t){s(n,t);function u(){this.constructor=n}n.prototype=t===null?Object.create(t):(u.prototype=t.prototype,new u)}}(),We=function(s,n,t,u){var i=arguments.length,e=i<3?n:u===null?u=Object.getOwnPropertyDescriptor(n,t):u,o;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")e=Reflect.decorate(s,n,t,u);else for(var c=s.length-1;c>=0;c--)(o=s[c])&&(e=(i<3?o(e):i>3?o(n,t,e):o(n,t))||e);return i>3&&e&&Object.defineProperty(n,t,e),e},ue=function(s,n){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(s,n)},$e=function(s,n,t,u){function i(e){return e instanceof t?e:new t(function(o){o(e)})}return new(t||(t=Promise))(function(e,o){function c(a){try{r(u.next(a))}catch(d){o(d)}}function h(a){try{r(u.throw(a))}catch(d){o(d)}}function r(a){a.done?e(a.value):i(a.value).then(c,h)}r((u=u.apply(s,n||[])).next())})},je=function(s,n){var t={label:0,sent:function(){if(e[0]&1)throw e[1];return e[1]},trys:[],ops:[]},u,i,e,o;return o={next:c(0),throw:c(1),return:c(2)},typeof Symbol=="function"&&(o[Symbol.iterator]=function(){return this}),o;function c(r){return function(a){return h([r,a])}}function h(r){if(u)throw new TypeError("Generator is already executing.");for(;t;)try{if(u=1,i&&(e=r[0]&2?i.return:r[0]?i.throw||((e=i.return)&&e.call(i),0):i.next)&&!(e=e.call(i,r[1])).done)return e;switch(i=0,e&&(r=[r[0]&2,e.value]),r[0]){case 0:case 1:e=r;break;case 4:return t.label++,{value:r[1],done:!1};case 5:t.label++,i=r[1],r=[0];continue;case 7:r=t.ops.pop(),t.trys.pop();continue;default:if(e=t.trys,!(e=e.length>0&&e[e.length-1])&&(r[0]===6||r[0]===2)){t=0;continue}if(r[0]===3&&(!e||r[1]>e[0]&&r[1]<e[3])){t.label=r[1];break}if(r[0]===6&&t.label<e[1]){t.label=e[1],e=r;break}if(e&&t.label<e[2]){t.label=e[2],t.ops.push(r);break}e[2]&&t.ops.pop(),t.trys.pop();continue}r=n.call(s,t)}catch(a){r=[6,a],i=0}finally{u=e=0}if(r[0]&5)throw r[1];return{value:r[0]?r[1]:void 0,done:!0}}},we=k.ERRORS,Ge=k.COMMUNITY_SITE_URL,He=w.isString,Ye=O.catchErrorsDecorator,Ve=function(s){Me(n,s);function n(){return s!==null&&s.apply(this,arguments)||this}return n.prototype.signIn=function(t){return $e(this,void 0,void 0,function(){var u,i,e,o,c,h,r;return je(this,function(a){switch(a.label){case 0:if(!He(t))throw new Error(JSON.stringify({code:we.INVALID_PARAMS,msg:"ticket must be a string"}));return u=this._cache.keys.refreshTokenKey,o=(e=this._request).send,c=["auth.signInWithTicket"],h={ticket:t},[4,this._cache.getStoreAsync(u)];case 1:return[4,o.apply(e,c.concat([(h.refresh_token=a.sent()||"",h)]))];case 2:return i=a.sent(),i.refresh_token?[4,this.setRefreshToken(i.refresh_token)]:[3,7];case 3:return a.sent(),[4,this._request.refreshAccessToken()];case 4:return a.sent(),_.fire(E.LOGIN_TYPE_CHANGED,{env:this._config.env,loginType:v.CUSTOM,persistence:this._config.persistence}),_.fire(E.LOGIN_STATE_CHANGED),[4,this.refreshUserInfo()];case 5:return a.sent(),r=new B({envId:this._config.env,cache:this._cache,request:this._request}),[4,r.checkLocalStateAsync()];case 6:return a.sent(),[2,r];case 7:throw new Error(JSON.stringify({code:we.OPERATION_FAIL,msg:"custom signIn failed"}))}})})},We([Ye({title:"自定义登录失败",messages:["请确认以下各项：","  1 - 当前环境是否开启了自定义登录","  2 - 调用 auth().customAuthProvider().signIn() 的语法或参数是否正确","  3 - ticket 是否归属于当前环境","  4 - 创建 ticket 的自定义登录私钥是否过期","如果问题依然存在，建议到官方问答社区提问或寻找帮助："+Ge]}),ue("design:type",Function),ue("design:paramtypes",[String]),ue("design:returntype",Promise)],n.prototype,"signIn",null),n}(L),Je=function(){var s=function(n,t){return s=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(u,i){u.__proto__=i}||function(u,i){for(var e in i)i.hasOwnProperty(e)&&(u[e]=i[e])},s(n,t)};return function(n,t){s(n,t);function u(){this.constructor=n}n.prototype=t===null?Object.create(t):(u.prototype=t.prototype,new u)}}(),W=function(s,n,t,u){var i=arguments.length,e=i<3?n:u===null?u=Object.getOwnPropertyDescriptor(n,t):u,o;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")e=Reflect.decorate(s,n,t,u);else for(var c=s.length-1;c>=0;c--)(o=s[c])&&(e=(i<3?o(e):i>3?o(n,t,e):o(n,t))||e);return i>3&&e&&Object.defineProperty(n,t,e),e},F=function(s,n){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(s,n)},$=function(s,n,t,u){function i(e){return e instanceof t?e:new t(function(o){o(e)})}return new(t||(t=Promise))(function(e,o){function c(a){try{r(u.next(a))}catch(d){o(d)}}function h(a){try{r(u.throw(a))}catch(d){o(d)}}function r(a){a.done?e(a.value):i(a.value).then(c,h)}r((u=u.apply(s,n||[])).next())})},j=function(s,n){var t={label:0,sent:function(){if(e[0]&1)throw e[1];return e[1]},trys:[],ops:[]},u,i,e,o;return o={next:c(0),throw:c(1),return:c(2)},typeof Symbol=="function"&&(o[Symbol.iterator]=function(){return this}),o;function c(r){return function(a){return h([r,a])}}function h(r){if(u)throw new TypeError("Generator is already executing.");for(;t;)try{if(u=1,i&&(e=r[0]&2?i.return:r[0]?i.throw||((e=i.return)&&e.call(i),0):i.next)&&!(e=e.call(i,r[1])).done)return e;switch(i=0,e&&(r=[r[0]&2,e.value]),r[0]){case 0:case 1:e=r;break;case 4:return t.label++,{value:r[1],done:!1};case 5:t.label++,i=r[1],r=[0];continue;case 7:r=t.ops.pop(),t.trys.pop();continue;default:if(e=t.trys,!(e=e.length>0&&e[e.length-1])&&(r[0]===6||r[0]===2)){t=0;continue}if(r[0]===3&&(!e||r[1]>e[0]&&r[1]<e[3])){t.label=r[1];break}if(r[0]===6&&t.label<e[1]){t.label=e[1],e=r;break}if(e&&t.label<e[2]){t.label=e[2],t.ops.push(r);break}e[2]&&t.ops.pop(),t.trys.pop();continue}r=n.call(s,t)}catch(a){r=[6,a],i=0}finally{u=e=0}if(r[0]&5)throw r[1];return{value:r[0]?r[1]:void 0,done:!0}}},ie=w.throwError,Xe=w.isString,se=k.ERRORS,G=k.COMMUNITY_SITE_URL,H=O.catchErrorsDecorator,Qe=function(s){Je(n,s);function n(){return s!==null&&s.apply(this,arguments)||this}return n.prototype.signIn=function(t,u){return $(this,void 0,void 0,function(){var i,e,o,c,h;return j(this,function(r){switch(r.label){case 0:return Xe(t)||ie(se.INVALID_PARAMS,"email must be a string"),i=this._cache.keys.refreshTokenKey,[4,this._request.send("auth.signIn",{loginType:"EMAIL",email:t,password:u,refresh_token:this._cache.getStore(i)||""})];case 1:return e=r.sent(),o=e.refresh_token,c=e.access_token,h=e.access_token_expire,o?[4,this.setRefreshToken(o)]:[3,8];case 2:return r.sent(),c&&h?[4,this.setAccessToken(c,h)]:[3,4];case 3:return r.sent(),[3,6];case 4:return[4,this._request.refreshAccessToken()];case 5:r.sent(),r.label=6;case 6:return[4,this.refreshUserInfo()];case 7:return r.sent(),_.fire(E.LOGIN_STATE_CHANGED),_.fire(E.LOGIN_TYPE_CHANGED,{env:this._config.env,loginType:v.EMAIL,persistence:this._config.persistence}),[2,new B({envId:this._config.env,cache:this._cache,request:this._request})];case 8:e.code?ie(se.OPERATION_FAIL,"Email login fail["+e.code+"] "+e.message):ie(se.OPERATION_FAIL,"Email login fail"),r.label=9;case 9:return[2]}})})},n.prototype.signUp=function(t,u){return $(this,void 0,void 0,function(){return j(this,function(i){return[2,this._request.send("auth.signUpWithEmailAndPassword",{email:t,password:u})]})})},n.prototype.resetPassword=function(t){return $(this,void 0,void 0,function(){return j(this,function(u){return[2,this._request.send("auth.sendPasswordResetEmail",{email:t})]})})},n.prototype.resetPasswordWithToken=function(t,u){return $(this,void 0,void 0,function(){return j(this,function(i){return[2,this._request.send("auth.resetPasswordWithToken",{token:t,newPassword:u})]})})},n.prototype.activate=function(t){return $(this,void 0,void 0,function(){return j(this,function(u){return[2,this._request.send("auth.activateEndUserMail",{token:t})]})})},W([H({title:"邮箱密码登录失败",messages:["请确认以下各项：","  1 - 调用 auth().emailAuthProvider() 的语法或参数是否正确","  2 - 当前环境是否开通了邮箱登录","  3 - 邮箱地址与密码是否匹配","如果问题依然存在，建议到官方问答社区提问或寻找帮助："+G]}),F("design:type",Function),F("design:paramtypes",[String,String]),F("design:returntype",Promise)],n.prototype,"signIn",null),W([H({title:"邮箱注册失败",messages:["请确认以下各项：","  1 - 调用 auth().signUpWithEmailAndPassword() 的语法或参数是否正确","  2 - 当前环境是否开通了邮箱登录","  3 - 此邮箱地址是否已经被其他用户占用","如果问题依然存在，建议到官方问答社区提问或寻找帮助："+G]}),F("design:type",Function),F("design:paramtypes",[String,String]),F("design:returntype",Promise)],n.prototype,"signUp",null),W([H({title:"重置密码失败",messages:["请确认以下各项：","  1 - 调用 auth().sendPasswordResetEmail() 的语法或参数是否正确","  2 - 当前环境是否开通了邮箱登录","  3 - 此邮箱地址是否已经与当前用户绑定","  4 - 此邮箱地址是否已经被其他用户占用","如果问题依然存在，建议到官方问答社区提问或寻找帮助："+G]}),F("design:type",Function),F("design:paramtypes",[String]),F("design:returntype",Promise)],n.prototype,"resetPassword",null),W([H({title:"重置密码失败",messages:["请确认以下各项：","  1 - 调用语法或参数是否正确","  2 - 当前环境是否开通了邮箱登录","如果问题依然存在，建议到官方问答社区提问或寻找帮助："+G]}),F("design:type",Function),F("design:paramtypes",[String,String]),F("design:returntype",Promise)],n.prototype,"resetPasswordWithToken",null),W([H({title:"邮箱激活失败",messages:["请确认以下各项：","  1 - 调用语法或参数是否正确","  2 - 当前环境是否开通了邮箱登录","如果问题依然存在，建议到官方问答社区提问或寻找帮助："+G]}),F("design:type",Function),F("design:paramtypes",[String]),F("design:returntype",Promise)],n.prototype,"activate",null),n}(L),ze=function(){var s=function(n,t){return s=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(u,i){u.__proto__=i}||function(u,i){for(var e in i)i.hasOwnProperty(e)&&(u[e]=i[e])},s(n,t)};return function(n,t){s(n,t);function u(){this.constructor=n}n.prototype=t===null?Object.create(t):(u.prototype=t.prototype,new u)}}(),Ze=function(s,n,t,u){var i=arguments.length,e=i<3?n:u===null?u=Object.getOwnPropertyDescriptor(n,t):u,o;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")e=Reflect.decorate(s,n,t,u);else for(var c=s.length-1;c>=0;c--)(o=s[c])&&(e=(i<3?o(e):i>3?o(n,t,e):o(n,t))||e);return i>3&&e&&Object.defineProperty(n,t,e),e},oe=function(s,n){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(s,n)},et=function(s,n,t,u){function i(e){return e instanceof t?e:new t(function(o){o(e)})}return new(t||(t=Promise))(function(e,o){function c(a){try{r(u.next(a))}catch(d){o(d)}}function h(a){try{r(u.throw(a))}catch(d){o(d)}}function r(a){a.done?e(a.value):i(a.value).then(c,h)}r((u=u.apply(s,n||[])).next())})},tt=function(s,n){var t={label:0,sent:function(){if(e[0]&1)throw e[1];return e[1]},trys:[],ops:[]},u,i,e,o;return o={next:c(0),throw:c(1),return:c(2)},typeof Symbol=="function"&&(o[Symbol.iterator]=function(){return this}),o;function c(r){return function(a){return h([r,a])}}function h(r){if(u)throw new TypeError("Generator is already executing.");for(;t;)try{if(u=1,i&&(e=r[0]&2?i.return:r[0]?i.throw||((e=i.return)&&e.call(i),0):i.next)&&!(e=e.call(i,r[1])).done)return e;switch(i=0,e&&(r=[r[0]&2,e.value]),r[0]){case 0:case 1:e=r;break;case 4:return t.label++,{value:r[1],done:!1};case 5:t.label++,i=r[1],r=[0];continue;case 7:r=t.ops.pop(),t.trys.pop();continue;default:if(e=t.trys,!(e=e.length>0&&e[e.length-1])&&(r[0]===6||r[0]===2)){t=0;continue}if(r[0]===3&&(!e||r[1]>e[0]&&r[1]<e[3])){t.label=r[1];break}if(r[0]===6&&t.label<e[1]){t.label=e[1],e=r;break}if(e&&t.label<e[2]){t.label=e[2],t.ops.push(r);break}e[2]&&t.ops.pop(),t.trys.pop();continue}r=n.call(s,t)}catch(a){r=[6,a],i=0}finally{u=e=0}if(r[0]&5)throw r[1];return{value:r[0]?r[1]:void 0,done:!0}}},nt=w.printWarn,V=k.ERRORS,rt=k.COMMUNITY_SITE_URL,ut=O.catchErrorsDecorator,it=function(s){ze(n,s);function n(){return s!==null&&s.apply(this,arguments)||this}return n.prototype.signIn=function(t,u){return et(this,void 0,void 0,function(){var i,e,o,c,h,r,a,d,p;return tt(this,function(S){switch(S.label){case 0:if(typeof t!="string")throw new Error(JSON.stringify({code:V.INVALID_PARAMS,msg:"username must be a string"}));return typeof u!="string"&&(u="",nt(V.INVALID_PARAMS,"password is empty")),i=this._cache.keys.refreshTokenKey,c=(o=this._request).send,h=["auth.signIn"],r={loginType:v.USERNAME,username:t,password:u},[4,this._cache.getStoreAsync(i)];case 1:return[4,c.apply(o,h.concat([(r.refresh_token=S.sent()||"",r)]))];case 2:return e=S.sent(),a=e.refresh_token,d=e.access_token_expire,p=e.access_token,a?[4,this.setRefreshToken(a)]:[3,9];case 3:return S.sent(),p&&d?[4,this.setAccessToken(p,d)]:[3,5];case 4:return S.sent(),[3,7];case 5:return[4,this._request.refreshAccessToken()];case 6:S.sent(),S.label=7;case 7:return[4,this.refreshUserInfo()];case 8:return S.sent(),_.fire(E.LOGIN_STATE_CHANGED),_.fire(E.LOGIN_TYPE_CHANGED,{env:this._config.env,loginType:v.USERNAME,persistence:this._config.persistence}),[2,new B({envId:this._config.env,cache:this._cache,request:this._request})];case 9:throw e.code?new Error(JSON.stringify({code:V.OPERATION_FAIL,msg:"login by username failed:["+e.code+"] "+e.message})):new Error(JSON.stringify({code:V.OPERATION_FAIL,msg:"login by username failed"}));case 10:return[2]}})})},Ze([ut({title:"用户名密码登录失败",messages:["请确认以下各项：","  1 - 调用 auth().signInWithUsernameAndPassword() 的语法或参数是否正确","  2 - 当前环境是否开通了用户名密码登录","  3 - 用户名密码是否匹配","如果问题依然存在，建议到官方问答社区提问或寻找帮助："+rt]}),oe("design:type",Function),oe("design:paramtypes",[String,String]),oe("design:returntype",Promise)],n.prototype,"signIn",null),n}(L),st=function(){var s=function(n,t){return s=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(u,i){u.__proto__=i}||function(u,i){for(var e in i)i.hasOwnProperty(e)&&(u[e]=i[e])},s(n,t)};return function(n,t){s(n,t);function u(){this.constructor=n}n.prototype=t===null?Object.create(t):(u.prototype=t.prototype,new u)}}(),ce=function(s,n,t,u){var i=arguments.length,e=i<3?n:u===null?u=Object.getOwnPropertyDescriptor(n,t):u,o;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")e=Reflect.decorate(s,n,t,u);else for(var c=s.length-1;c>=0;c--)(o=s[c])&&(e=(i<3?o(e):i>3?o(n,t,e):o(n,t))||e);return i>3&&e&&Object.defineProperty(n,t,e),e},U=function(s,n){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(s,n)},ae=function(s,n,t,u){function i(e){return e instanceof t?e:new t(function(o){o(e)})}return new(t||(t=Promise))(function(e,o){function c(a){try{r(u.next(a))}catch(d){o(d)}}function h(a){try{r(u.throw(a))}catch(d){o(d)}}function r(a){a.done?e(a.value):i(a.value).then(c,h)}r((u=u.apply(s,n||[])).next())})},he=function(s,n){var t={label:0,sent:function(){if(e[0]&1)throw e[1];return e[1]},trys:[],ops:[]},u,i,e,o;return o={next:c(0),throw:c(1),return:c(2)},typeof Symbol=="function"&&(o[Symbol.iterator]=function(){return this}),o;function c(r){return function(a){return h([r,a])}}function h(r){if(u)throw new TypeError("Generator is already executing.");for(;t;)try{if(u=1,i&&(e=r[0]&2?i.return:r[0]?i.throw||((e=i.return)&&e.call(i),0):i.next)&&!(e=e.call(i,r[1])).done)return e;switch(i=0,e&&(r=[r[0]&2,e.value]),r[0]){case 0:case 1:e=r;break;case 4:return t.label++,{value:r[1],done:!1};case 5:t.label++,i=r[1],r=[0];continue;case 7:r=t.ops.pop(),t.trys.pop();continue;default:if(e=t.trys,!(e=e.length>0&&e[e.length-1])&&(r[0]===6||r[0]===2)){t=0;continue}if(r[0]===3&&(!e||r[1]>e[0]&&r[1]<e[3])){t.label=r[1];break}if(r[0]===6&&t.label<e[1]){t.label=e[1],e=r;break}if(e&&t.label<e[2]){t.label=e[2],t.ops.push(r);break}e[2]&&t.ops.pop(),t.trys.pop();continue}r=n.call(s,t)}catch(a){r=[6,a],i=0}finally{u=e=0}if(r[0]&5)throw r[1];return{value:r[0]?r[1]:void 0,done:!0}}},J=w.throwError,fe=w.isString,ot=w.transformPhone,X=k.ERRORS,de=k.COMMUNITY_SITE_URL,le=O.catchErrorsDecorator,Q={SIGNIN:"SIGNIN",SIGNUP:"SIGNUP",FORCERESETPWD:"FORCERESETPWD"},ct=function(s){st(n,s);function n(){return s!==null&&s.apply(this,arguments)||this}return n.prototype.signIn=function(t){return ae(this,void 0,void 0,function(){var u,i,e,o,c,h,r,a,d;return he(this,function(p){switch(p.label){case 0:return u=t.phoneNumber,i=t.phoneCode,e=t.password,o=t.signMethod,fe(u)||J(X.INVALID_PARAMS,"phoneNumber must be a string"),!fe(i)&&!fe(e)&&J(X.INVALID_PARAMS,"phoneCode or password must be a string"),o||(o=Q.SIGNIN),c=this._cache.keys.refreshTokenKey,[4,this._request.send("auth.signIn",{loginType:v.PHONE,phoneNumber:ot(u),phoneCode:i,password:e,refresh_token:this._cache.getStore(c)||"",signMethod:o})];case 1:return h=p.sent(),r=h.refresh_token,a=h.access_token,d=h.access_token_expire,r?[4,this.setRefreshToken(r)]:[3,8];case 2:return p.sent(),a&&d?[4,this.setAccessToken(a,d)]:[3,4];case 3:return p.sent(),[3,6];case 4:return[4,this._request.refreshAccessToken()];case 5:p.sent(),p.label=6;case 6:return[4,this.refreshUserInfo()];case 7:return p.sent(),_.fire(E.LOGIN_STATE_CHANGED),_.fire(E.LOGIN_TYPE_CHANGED,{env:this._config.env,loginType:v.PHONE,persistence:this._config.persistence}),[2,new B({envId:this._config.env,cache:this._cache,request:this._request})];case 8:h.code?J(X.OPERATION_FAIL,"Phone login fail["+h.code+"] "+h.message):J(X.OPERATION_FAIL,"Phone login fail"),p.label=9;case 9:return[2]}})})},n.prototype.signUp=function(t,u,i){return ae(this,void 0,void 0,function(){return he(this,function(e){return[2,this.signIn({phoneNumber:t,phoneCode:u,password:i,signMethod:Q.SIGNUP})]})})},n.prototype.forceResetPwd=function(t,u,i){return ae(this,void 0,void 0,function(){return he(this,function(e){return[2,this.signIn({phoneNumber:t,phoneCode:u,password:i,signMethod:Q.FORCERESETPWD})]})})},ce([le({title:"手机号登录失败",messages:["请确认以下各项：","  1 - 调用 auth().SmsAuthProvider() 的语法或参数是否正确","  2 - 当前环境是否开通了短信验证码登录","  3 - 短信验证码/密码是否正确","如果问题依然存在，建议到官方问答社区提问或寻找帮助："+de]}),U("design:type",Function),U("design:paramtypes",[Object]),U("design:returntype",Promise)],n.prototype,"signIn",null),ce([le({title:"手机短信注册失败",messages:["请确认以下各项：","  1 - 调用 auth().signUpWithPhoneCode() 的语法或参数是否正确","  2 - 当前环境是否开通了短信验证码登录","如果问题依然存在，建议到官方问答社区提问或寻找帮助："+de]}),U("design:type",Function),U("design:paramtypes",[String,String,String]),U("design:returntype",Promise)],n.prototype,"signUp",null),ce([le({title:"手机密码重置失败",messages:["请确认以下各项：","  1 - 调用 auth().forceResetPwd() 的语法或参数是否正确","  2 - 当前环境是否开通了短信验证码登录","如果问题依然存在，建议到官方问答社区提问或寻找帮助："+de]}),U("design:type",Function),U("design:paramtypes",[String,String,String]),U("design:returntype",Promise)],n.prototype,"forceResetPwd",null),n}(L),g=function(){return g=Object.assign||function(s){for(var n,t=1,u=arguments.length;t<u;t++){n=arguments[t];for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(s[i]=n[i])}return s},g.apply(this,arguments)},m=function(s,n,t,u){var i=arguments.length,e=i<3?n:u===null?u=Object.getOwnPropertyDescriptor(n,t):u,o;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")e=Reflect.decorate(s,n,t,u);else for(var c=s.length-1;c>=0;c--)(o=s[c])&&(e=(i<3?o(e):i>3?o(n,t,e):o(n,t))||e);return i>3&&e&&Object.defineProperty(n,t,e),e},f=function(s,n){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(s,n)},l=function(s,n,t,u){function i(e){return e instanceof t?e:new t(function(o){o(e)})}return new(t||(t=Promise))(function(e,o){function c(a){try{r(u.next(a))}catch(d){o(d)}}function h(a){try{r(u.throw(a))}catch(d){o(d)}}function r(a){a.done?e(a.value):i(a.value).then(c,h)}r((u=u.apply(s,n||[])).next())})},y=function(s,n){var t={label:0,sent:function(){if(e[0]&1)throw e[1];return e[1]},trys:[],ops:[]},u,i,e,o;return o={next:c(0),throw:c(1),return:c(2)},typeof Symbol=="function"&&(o[Symbol.iterator]=function(){return this}),o;function c(r){return function(a){return h([r,a])}}function h(r){if(u)throw new TypeError("Generator is already executing.");for(;t;)try{if(u=1,i&&(e=r[0]&2?i.return:r[0]?i.throw||((e=i.return)&&e.call(i),0):i.next)&&!(e=e.call(i,r[1])).done)return e;switch(i=0,e&&(r=[r[0]&2,e.value]),r[0]){case 0:case 1:e=r;break;case 4:return t.label++,{value:r[1],done:!1};case 5:t.label++,i=r[1],r=[0];continue;case 7:r=t.ops.pop(),t.trys.pop();continue;default:if(e=t.trys,!(e=e.length>0&&e[e.length-1])&&(r[0]===6||r[0]===2)){t=0;continue}if(r[0]===3&&(!e||r[1]>e[0]&&r[1]<e[3])){t.label=r[1];break}if(r[0]===6&&t.label<e[1]){t.label=e[1],e=r;break}if(e&&t.label<e[2]){t.label=e[2],t.ops.push(r);break}e[2]&&t.ops.pop(),t.trys.pop();continue}r=n.call(s,t)}catch(a){r=[6,a],i=0}finally{u=e=0}if(r[0]&5)throw r[1];return{value:r[0]?r[1]:void 0,done:!0}}},at=ke.CloudbaseEventEmitter,ht=Fe.RUNTIME,ye=w.printWarn,Ee=w.throwError,pe=w.transformPhone,N=k.ERRORS,I=k.COMMUNITY_SITE_URL,T=O.catchErrorsDecorator,ft="auth",_=new at,dt=function(){function s(n){var t=n.cache,u=n.request;this._cache=t,this._request=u,this._setUserInfo()}return s.prototype.checkLocalInfo=function(){return l(this,void 0,void 0,function(){return y(this,function(n){return this.uid=this._getLocalUserInfo("uid"),this.loginType=this._getLocalUserInfo("loginType"),this.openid=this._getLocalUserInfo("wxOpenId"),this.wxOpenId=this._getLocalUserInfo("wxOpenId"),this.wxPublicId=this._getLocalUserInfo("wxPublicId"),this.unionId=this._getLocalUserInfo("wxUnionId"),this.qqMiniOpenId=this._getLocalUserInfo("qqMiniOpenId"),this.customUserId=this._getLocalUserInfo("customUserId"),this.nickName=this._getLocalUserInfo("nickName"),this.gender=this._getLocalUserInfo("gender"),this.avatarUrl=this._getLocalUserInfo("avatarUrl"),this.email=this._getLocalUserInfo("email"),this.hasPassword=!!this._getLocalUserInfo("hasPassword"),this.phone=this._getLocalUserInfo("phone"),this.username=this._getLocalUserInfo("username"),this.location={country:this._getLocalUserInfo("country"),province:this._getLocalUserInfo("province"),city:this._getLocalUserInfo("city")},[2]})})},s.prototype.checkLocalInfoAsync=function(){return l(this,void 0,void 0,function(){var n,t,u,i,e,o,c,h,r,a,d,p,S,P,_e,ge,ve,D;return y(this,function(A){switch(A.label){case 0:return n=this,[4,this._getLocalUserInfoAsync("uid")];case 1:return n.uid=A.sent(),t=this,[4,this._getLocalUserInfoAsync("loginType")];case 2:return t.loginType=A.sent(),u=this,[4,this._getLocalUserInfoAsync("wxOpenId")];case 3:return u.openid=A.sent(),i=this,[4,this._getLocalUserInfoAsync("wxOpenId")];case 4:return i.wxOpenId=A.sent(),e=this,[4,this._getLocalUserInfoAsync("wxPublicId")];case 5:return e.wxPublicId=A.sent(),o=this,[4,this._getLocalUserInfoAsync("wxUnionId")];case 6:return o.unionId=A.sent(),c=this,[4,this._getLocalUserInfoAsync("qqMiniOpenId")];case 7:return c.qqMiniOpenId=A.sent(),h=this,[4,this._getLocalUserInfoAsync("customUserId")];case 8:return h.customUserId=A.sent(),r=this,[4,this._getLocalUserInfoAsync("nickName")];case 9:return r.nickName=A.sent(),a=this,[4,this._getLocalUserInfoAsync("gender")];case 10:return a.gender=A.sent(),d=this,[4,this._getLocalUserInfoAsync("avatarUrl")];case 11:return d.avatarUrl=A.sent(),p=this,[4,this._getLocalUserInfoAsync("email")];case 12:return p.email=A.sent(),S=this,P=Boolean,[4,this._getLocalUserInfoAsync("hasPassword")];case 13:return S.hasPassword=P.apply(void 0,[A.sent()]),_e=this,[4,this._getLocalUserInfoAsync("phone")];case 14:return _e.phone=A.sent(),ge=this,[4,this._getLocalUserInfoAsync("username")];case 15:return ge.username=A.sent(),ve=this,D={},[4,this._getLocalUserInfoAsync("country")];case 16:return D.country=A.sent(),[4,this._getLocalUserInfoAsync("province")];case 17:return D.province=A.sent(),[4,this._getLocalUserInfoAsync("city")];case 18:return ve.location=(D.city=A.sent(),D),[2]}})})},s.prototype.linkWithTicket=function(n){if(typeof n!="string")throw new Error("ticket must be string");return this._request.send("auth.linkWithTicket",{ticket:n})},s.prototype.linkWithRedirect=function(n){n.signInWithRedirect()},s.prototype.getLinkedUidList=function(){return l(this,void 0,void 0,function(){var n,t,u,i,e,o;return y(this,function(c){switch(c.label){case 0:return[4,this._request.send("auth.getLinkedUidList",{})];case 1:for(n=c.sent().data,t=!1,u=n.users,i=0,e=u;i<e.length;i++)if(o=e[i],o.wxOpenId&&o.wxPublicId){t=!0;break}return[2,{users:u,hasPrimaryUid:t}]}})})},s.prototype.setPrimaryUid=function(n){return this._request.send("auth.setPrimaryUid",{uid:n})},s.prototype.unlink=function(n){return this._request.send("auth.unlink",{platform:n})},s.prototype.update=function(n){return l(this,void 0,void 0,function(){var t,u,i,e,o,c,h;return y(this,function(r){switch(r.label){case 0:return t=n.nickName,u=n.gender,i=n.avatarUrl,e=n.province,o=n.country,c=n.city,[4,this._request.send("auth.updateUserInfo",{nickName:t,gender:u,avatarUrl:i,province:e,country:o,city:c})];case 1:return h=r.sent().data,this._setLocalUserInfo(h),[2]}})})},s.prototype.updatePassword=function(n,t){return this._request.send("auth.updatePassword",{oldPassword:t,newPassword:n})},s.prototype.updateEmail=function(n,t){return this._request.send("auth.updateEmail",{newEmail:n,password:t})},s.prototype.updateUsername=function(n){return typeof n!="string"&&Ee(N.INVALID_PARAMS,"username must be a string"),this._request.send("auth.updateUsername",{username:n})},s.prototype.refresh=function(){return l(this,void 0,void 0,function(){var n,t;return y(this,function(u){switch(u.label){case 0:return n="auth.getUserInfo",[4,this._request.send(n,{})];case 1:return t=u.sent().data,this._setLocalUserInfo(t),[2,t]}})})},s.prototype.linkWithPhoneNumber=function(n,t){return l(this,void 0,void 0,function(){return y(this,function(u){return[2,this._request.send("auth.linkOrUpdatePhoneNumber",{phoneNumber:pe(n),phoneCode:t})]})})},s.prototype.updatePhoneNumber=function(n,t){return l(this,void 0,void 0,function(){return y(this,function(u){return[2,this._request.send("auth.linkOrUpdatePhoneNumber",{phoneNumber:pe(n),phoneCode:t})]})})},s.prototype._getLocalUserInfo=function(n){var t=this._cache.keys.userInfoKey,u=this._cache.getStore(t);return u[n]},s.prototype._getLocalUserInfoAsync=function(n){return l(this,void 0,void 0,function(){var t,u;return y(this,function(i){switch(i.label){case 0:return t=this._cache.keys.userInfoKey,[4,this._cache.getStoreAsync(t)];case 1:return u=i.sent(),[2,u[n]]}})})},s.prototype._setUserInfo=function(){var n=this,t=this._cache.keys.userInfoKey,u=this._cache.getStore(t);["uid","loginType","openid","wxOpenId","wxPublicId","unionId","qqMiniOpenId","email","hasPassword","customUserId","nickName","gender","avatarUrl","phone","username"].forEach(function(i){n[i]=u[i]}),this.location={country:u.country,province:u.province,city:u.city}},s.prototype._setLocalUserInfo=function(n){var t=this._cache.keys.userInfoKey;this._cache.setStore(t,n),this._setUserInfo()},m([T({title:"绑定自定义登录失败",messages:["请确认以下各项：","  1 - 调用 User.linkWithTicket() 的语法或参数是否正确","  2 - 此账户是否已经绑定自定义登录","  3 - ticket 参数是否归属当前环境","  4 - 创建 ticket 的自定义登录私钥是否过期","如果问题依然存在，建议到官方问答社区提问或寻找帮助："+I]}),f("design:type",Function),f("design:paramtypes",[String]),f("design:returntype",Promise)],s.prototype,"linkWithTicket",null),m([T({title:"绑定第三方登录方式失败",messages:["请确认以下各项：","  1 - 调用 User.linkWithRedirect() 的语法或参数是否正确","  2 - 此账户是否已经绑定此第三方","  3 - 此第三方是否已经授权","如果问题依然存在，建议到官方问答社区提问或寻找帮助："+I]}),f("design:type",Function),f("design:paramtypes",[Object]),f("design:returntype",void 0)],s.prototype,"linkWithRedirect",null),m([T({title:"获取账户列表失败",messages:["请确认以下各项：","  1 - 调用 User.getLinkedUidList() 的语法或参数是否正确","如果问题依然存在，建议到官方问答社区提问或寻找帮助："+I]}),f("design:type",Function),f("design:paramtypes",[]),f("design:returntype",Promise)],s.prototype,"getLinkedUidList",null),m([T({title:"设置微信主账号失败",messages:["请确认以下各项：","  1 - 调用 User.setPrimaryUid() 的语法或参数是否正确","如果问题依然存在，建议到官方问答社区提问或寻找帮助："+I]}),f("design:type",Function),f("design:paramtypes",[String]),f("design:returntype",void 0)],s.prototype,"setPrimaryUid",null),m([T({title:"接触绑定失败",messages:["请确认以下各项：","  1 - 调用 User.unlink() 的语法或参数是否正确","  2 - 当前账户是否已经与此登录方式解绑","如果问题依然存在，建议到官方问答社区提问或寻找帮助："+I]}),f("design:type",Function),f("design:paramtypes",[String]),f("design:returntype",void 0)],s.prototype,"unlink",null),m([T({title:"更新用户信息失败",messages:["请确认以下各项：","  1 - 调用 User.update() 的语法或参数是否正确","  2 - 用户信息中是否包含非法值","如果问题依然存在，建议到官方问答社区提问或寻找帮助："+I]}),f("design:type",Function),f("design:paramtypes",[Object]),f("design:returntype",Promise)],s.prototype,"update",null),m([T({title:"更新密码失败",messages:["请确认以下各项：","  1 - 调用 User.updatePassword() 的语法或参数是否正确","  3 - 新密码中是否包含非法字符","如果问题依然存在，建议到官方问答社区提问或寻找帮助："+I]}),f("design:type",Function),f("design:paramtypes",[String,String]),f("design:returntype",void 0)],s.prototype,"updatePassword",null),m([T({title:"更新邮箱地址失败",messages:["请确认以下各项：","  1 - 调用 User.updateEmail() 的语法或参数是否正确","  2 - 当前环境是否开通了邮箱密码登录","如果问题依然存在，建议到官方问答社区提问或寻找帮助："+I]}),f("design:type",Function),f("design:paramtypes",[String,String]),f("design:returntype",void 0)],s.prototype,"updateEmail",null),m([T({title:"更新用户名失败",messages:["请确认以下各项：","  1 - 调用 User.updateUsername() 的语法或参数是否正确","  2 - 当前环境是否开通了用户名密码登录","如果问题依然存在，建议到官方问答社区提问或寻找帮助："+I]}),f("design:type",Function),f("design:paramtypes",[String]),f("design:returntype",void 0)],s.prototype,"updateUsername",null),m([T({title:"刷新本地用户信息失败",messages:["请确认以下各项：","  1 - 调用 User.refresh() 的语法或参数是否正确","如果问题依然存在，建议到官方问答社区提问或寻找帮助："+I]}),f("design:type",Function),f("design:paramtypes",[]),f("design:returntype",Promise)],s.prototype,"refresh",null),m([T({title:"绑定手机号失败",messages:["请确认以下各项：","  1 - 调用 auth().linkWithPhoneNumber() 的语法或参数是否正确","  2 - 当前环境是否开通了短信验证码登录","如果问题依然存在，建议到官方问答社区提问或寻找帮助："+I]}),f("design:type",Function),f("design:paramtypes",[String,String]),f("design:returntype",Promise)],s.prototype,"linkWithPhoneNumber",null),m([T({title:"更新手机号失败",messages:["请确认以下各项：","  1 - 调用语法或参数是否正确","  2 - 当前环境是否开通了短信验证码登录","如果问题依然存在，建议到官方问答社区提问或寻找帮助："+I]}),f("design:type",Function),f("design:paramtypes",[String,String]),f("design:returntype",Promise)],s.prototype,"updatePhoneNumber",null),s}(),B=function(){function s(n){var t=n.envId,u=n.cache,i=n.request;t||Ee(N.INVALID_PARAMS,"envId is not defined"),this._cache=u,this.user=new dt({cache:u,request:i})}return s.prototype.checkLocalState=function(){return l(this,void 0,void 0,function(){var n,t,u,i,e,o,c;return y(this,function(h){return n=this._cache.keys,t=n.refreshTokenKey,u=n.accessTokenKey,i=n.accessTokenExpireKey,e=this._cache.getStore(t),o=this._cache.getStore(u),c=this._cache.getStore(i),this.credential={refreshToken:e,accessToken:o,accessTokenExpire:c},this._loginType=this._cache.getStore(this._cache.keys.loginTypeKey),this.user.checkLocalInfo(),[2]})})},s.prototype.checkLocalStateAsync=function(){return l(this,void 0,void 0,function(){var n,t,u,i,e,o,c,h;return y(this,function(r){switch(r.label){case 0:return n=this._cache.keys,t=n.refreshTokenKey,u=n.accessTokenKey,i=n.accessTokenExpireKey,[4,this._cache.getStoreAsync(t)];case 1:return e=r.sent(),[4,this._cache.getStoreAsync(u)];case 2:return o=r.sent(),[4,this._cache.getStoreAsync(i)];case 3:return c=r.sent(),this.credential={refreshToken:e,accessToken:o,accessTokenExpire:c},h=this,[4,this._cache.getStoreAsync(this._cache.keys.loginTypeKey)];case 4:return h._loginType=r.sent(),[4,this.user.checkLocalInfoAsync()];case 5:return r.sent(),[2]}})})},Object.defineProperty(s.prototype,"isAnonymousAuth",{get:function(){return this.loginType===v.ANONYMOUS},enumerable:!1,configurable:!0}),Object.defineProperty(s.prototype,"isCustomAuth",{get:function(){return this.loginType===v.CUSTOM},enumerable:!1,configurable:!0}),Object.defineProperty(s.prototype,"isWeixinAuth",{get:function(){return this.loginType===v.WECHAT||this.loginType===v.WECHAT_OPEN||this.loginType===v.WECHAT_PUBLIC},enumerable:!1,configurable:!0}),Object.defineProperty(s.prototype,"isUsernameAuth",{get:function(){return this.loginType===v.USERNAME},enumerable:!1,configurable:!0}),Object.defineProperty(s.prototype,"loginType",{get:function(){return this._loginType},enumerable:!1,configurable:!0}),Object.defineProperty(s.prototype,"isPhoneAuth",{get:function(){return this.loginType===v.PHONE},enumerable:!1,configurable:!0}),s}(),Se=function(){function s(n){this._config=n,this._cache=n.cache,this._request=n.request,this._runtime=n.runtime||ht.WEB,_.on(E.LOGIN_TYPE_CHANGED,this._onLoginTypeChanged.bind(this))}return Object.defineProperty(s.prototype,"currentUser",{get:function(){if(this._cache.mode==="async"){ye(N.INVALID_OPERATION,"current platform's storage is asynchronous, please use getCurrenUser insteed");return}var n=this.hasLoginState();return n&&n.user||null},enumerable:!1,configurable:!0}),Object.defineProperty(s.prototype,"loginType",{get:function(){return this._cache.getStore(this._cache.keys.loginTypeKey)},enumerable:!1,configurable:!0}),s.prototype.getCurrenUser=function(){return l(this,void 0,void 0,function(){var n;return y(this,function(t){switch(t.label){case 0:return[4,this.getLoginState()];case 1:return n=t.sent(),n?[4,n.user.checkLocalInfoAsync()]:[3,3];case 2:return t.sent(),[2,n.user||null];case 3:return[2,null]}})})},s.prototype.getLoginType=function(){return l(this,void 0,void 0,function(){return y(this,function(n){switch(n.label){case 0:return[4,this._cache.getStoreAsync(this._cache.keys.loginTypeKey)];case 1:return[2,n.sent()]}})})},s.prototype.getAccessToken=function(){return l(this,void 0,void 0,function(){var n;return y(this,function(t){switch(t.label){case 0:return n={},[4,this._request.getAccessToken()];case 1:return[2,(n.accessToken=t.sent().accessToken,n.env=this._config.env,n)]}})})},s.prototype.weixinAuthProvider=function(n){var t=n.appid,u=n.scope,i=n.state;return this._weixinAuthProvider||(this._weixinAuthProvider=new Re(g(g({},this._config),{cache:this._cache,request:this._request,runtime:this._runtime}),t,u,i)),this._weixinAuthProvider},s.prototype.anonymousAuthProvider=function(){return this._anonymousAuthProvider||(this._anonymousAuthProvider=new Ke(g(g({},this._config),{cache:this._cache,request:this._request}))),this._anonymousAuthProvider},s.prototype.customAuthProvider=function(){return this._customAuthProvider||(this._customAuthProvider=new Ve(g(g({},this._config),{cache:this._cache,request:this._request}))),this._customAuthProvider},s.prototype.emailAuthProvider=function(){return this._emailAuthProvider||(this._emailAuthProvider=new Qe(g(g({},this._config),{cache:this._cache,request:this._request}))),this._emailAuthProvider},s.prototype.usernameAuthProvider=function(){return this._usernameAuthProvider||(this._usernameAuthProvider=new it(g(g({},this._config),{cache:this._cache,request:this._request}))),this._usernameAuthProvider},s.prototype.phoneAuthProvider=function(){return this._phoneAuthProvider||(this._phoneAuthProvider=new ct(g(g({},this._config),{cache:this._cache,request:this._request}))),this._phoneAuthProvider},s.prototype.signInWithUsernameAndPassword=function(n,t){return l(this,void 0,void 0,function(){return y(this,function(u){return[2,this.usernameAuthProvider().signIn(n,t)]})})},s.prototype.isUsernameRegistered=function(n){return l(this,void 0,void 0,function(){var t;return y(this,function(u){switch(u.label){case 0:return typeof n!="string"&&Ee(N.INVALID_PARAMS,"username must be a string"),[4,this._request.send("auth.isUsernameRegistered",{username:n})];case 1:return t=u.sent().data,[2,t==null?void 0:t.isRegistered]}})})},s.prototype.signInWithEmailAndPassword=function(n,t){return l(this,void 0,void 0,function(){return y(this,function(u){return[2,this.emailAuthProvider().signIn(n,t)]})})},s.prototype.signUpWithEmailAndPassword=function(n,t){return l(this,void 0,void 0,function(){return y(this,function(u){return[2,this.emailAuthProvider().signUp(n,t)]})})},s.prototype.sendPasswordResetEmail=function(n){return l(this,void 0,void 0,function(){return y(this,function(t){return[2,this.emailAuthProvider().resetPassword(n)]})})},s.prototype.signOut=function(){return l(this,void 0,void 0,function(){var n,t,u,i,e,o,c;return y(this,function(h){switch(h.label){case 0:return n=this._cache.keys,t=n.refreshTokenKey,u=n.accessTokenKey,i=n.accessTokenExpireKey,e="auth.logout",[4,this._cache.getStoreAsync(t)];case 1:return o=h.sent(),o?[4,this._request.send(e,{refresh_token:o})]:[2];case 2:return c=h.sent(),this._cache.removeStoreAsync(t),this._cache.removeStoreAsync(u),this._cache.removeStoreAsync(i),_.fire(E.LOGIN_STATE_CHANGED),_.fire(E.LOGIN_TYPE_CHANGED,{env:this._config.env,loginType:v.NULL,persistence:this._config.persistence}),[2,c]}})})},s.prototype.onLoginStateChanged=function(n){return l(this,void 0,void 0,function(){var t,u=this;return y(this,function(i){switch(i.label){case 0:return _.on(E.LOGIN_STATE_CHANGED,function(){return l(u,void 0,void 0,function(){var e;return y(this,function(o){switch(o.label){case 0:return[4,this.getLoginState()];case 1:return e=o.sent(),n.call(this,e),[2]}})})}),[4,this.getLoginState()];case 1:return t=i.sent(),n.call(this,t),[2]}})})},s.prototype.onLoginStateExpired=function(n){_.on(E.LOGIN_STATE_EXPIRED,n.bind(this))},s.prototype.onAccessTokenRefreshed=function(n){_.on(E.ACCESS_TOKEN_REFRESHD,n.bind(this))},s.prototype.onAnonymousConverted=function(n){_.on(E.ANONYMOUS_CONVERTED,n.bind(this))},s.prototype.onLoginTypeChanged=function(n){var t=this;_.on(E.LOGIN_TYPE_CHANGED,function(){return l(t,void 0,void 0,function(){var u;return y(this,function(i){switch(i.label){case 0:return[4,this.getLoginState()];case 1:return u=i.sent(),n.call(this,u),[2]}})})})},s.prototype.hasLoginState=function(){if(this._cache.mode==="async"){ye(N.INVALID_OPERATION,"current platform's storage is asynchronous, please use getLoginState insteed");return}var n=this._cache.keys.refreshTokenKey,t=this._cache.getStore(n);if(t){var u=new B({envId:this._config.env,cache:this._cache,request:this._request});return u.checkLocalState(),u}else return null},s.prototype.getLoginState=function(){return l(this,void 0,void 0,function(){var n,t,u;return y(this,function(i){switch(i.label){case 0:return n=this._cache.keys.refreshTokenKey,[4,this._cache.getStoreAsync(n)];case 1:return t=i.sent(),t?(u=new B({envId:this._config.env,cache:this._cache,request:this._request}),[4,u.checkLocalStateAsync()]):[3,3];case 2:return i.sent(),[2,u];case 3:return[2,null]}})})},s.prototype.shouldRefreshAccessToken=function(n){this._request._shouldRefreshAccessTokenHook=n.bind(this)},s.prototype.getUserInfo=function(){return l(this,void 0,void 0,function(){var n,t;return y(this,function(u){switch(u.label){case 0:return n="auth.getUserInfo",[4,this._request.send(n,{})];case 1:return t=u.sent(),t.code?[2,t]:[2,g(g({},t.data),{requestId:t.seqId})]}})})},s.prototype.getAuthHeader=function(){var n=this._cache.keys,t=n.refreshTokenKey,u=n.accessTokenKey,i=this._cache.getStore(t),e=this._cache.getStore(u);return{"x-cloudbase-credentials":e+"/@@/"+i}},s.prototype.getAuthHeaderAsync=function(){return l(this,void 0,void 0,function(){var n,t,u,i,e;return y(this,function(o){switch(o.label){case 0:return[4,this._request.refreshAccessToken()];case 1:return o.sent(),n=this._cache.keys,t=n.refreshTokenKey,u=n.accessTokenKey,[4,this._cache.getStoreAsync(t)];case 2:return i=o.sent(),[4,this._cache.getStoreAsync(u)];case 3:return e=o.sent(),[2,{"x-cloudbase-credentials":e+"/@@/"+i}]}})})},s.prototype.sendPhoneCode=function(n){return l(this,void 0,void 0,function(){var t;return y(this,function(u){switch(u.label){case 0:return[4,this._request.send("auth.sendPhoneCode",{phoneNumber:pe(n)})];case 1:return t=u.sent().data,[2,t.SendStatus==="Ok"]}})})},s.prototype.signUpWithPhoneCode=function(n,t,u){return l(this,void 0,void 0,function(){return y(this,function(i){return[2,this.phoneAuthProvider().signUp(n,t,u)]})})},s.prototype.signInWithPhoneCodeOrPassword=function(n){return l(this,void 0,void 0,function(){return y(this,function(t){return[2,this.phoneAuthProvider().signIn(n)]})})},s.prototype.forceResetPwdByPhoneCode=function(n){return l(this,void 0,void 0,function(){return y(this,function(t){return[2,this.phoneAuthProvider().signIn(g(g({},n),{signMethod:Q.FORCERESETPWD}))]})})},s.prototype._onLoginTypeChanged=function(n){return l(this,void 0,void 0,function(){var t,u,i,e;return y(this,function(o){switch(o.label){case 0:return t=n.data,u=t.loginType,i=t.persistence,e=t.env,e!==this._config.env?[2]:[4,this._cache.updatePersistenceAsync(i)];case 1:return o.sent(),[4,this._cache.setStoreAsync(this._cache.keys.loginTypeKey,u)];case 2:return o.sent(),[2]}})})},m([T({title:"获取用户信息失败",messages:["请确认以下各项：","  1 - 调用 auth().getCurrenUser() 的语法或参数是否正确","如果问题依然存在，建议到官方问答社区提问或寻找帮助："+I]}),f("design:type",Function),f("design:paramtypes",[]),f("design:returntype",Promise)],s.prototype,"getCurrenUser",null),m([T({title:"获取用户是否被占用失败",messages:["请确认以下各项：","  1 - 调用 auth().isUsernameRegistered() 的语法或参数是否正确","如果问题依然存在，建议到官方问答社区提问或寻找帮助："+I]}),f("design:type",Function),f("design:paramtypes",[String]),f("design:returntype",Promise)],s.prototype,"isUsernameRegistered",null),m([T({title:"用户登出失败",messages:["请确认以下各项：","  1 - 调用 auth().signOut() 的语法或参数是否正确","  2 - 当前用户是否为匿名登录（匿名登录不支持signOut）","如果问题依然存在，建议到官方问答社区提问或寻找帮助："+I]}),f("design:type",Function),f("design:paramtypes",[]),f("design:returntype",Promise)],s.prototype,"signOut",null),m([T({title:"获取本地登录态失败",messages:["请确认以下各项：","  1 - 调用 auth().getLoginState() 的语法或参数是否正确","如果问题依然存在，建议到官方问答社区提问或寻找帮助："+I]}),f("design:type",Function),f("design:paramtypes",[]),f("design:returntype",Promise)],s.prototype,"getLoginState",null),m([T({title:"获取用户信息失败",messages:["请确认以下各项：","  1 - 是否已登录","  2 - 调用 auth().getUserInfo() 的语法或参数是否正确","如果问题依然存在，建议到官方问答社区提问或寻找帮助："+I]}),f("design:type",Function),f("design:paramtypes",[]),f("design:returntype",Promise)],s.prototype,"getUserInfo",null),m([T({title:"发送短信验证码失败",messages:["请确认以下各项：","  1 - 调用语法或参数是否正确","  2 - 当前环境是否开通了短信验证码登录","如果问题依然存在，建议到官方问答社区提问或寻找帮助："+I]}),f("design:type",Function),f("design:paramtypes",[String]),f("design:returntype",Promise)],s.prototype,"sendPhoneCode",null),s}(),E={LOGIN_STATE_CHANGED:"loginStateChanged",LOGIN_STATE_EXPIRED:"loginStateExpire",LOGIN_TYPE_CHANGED:"loginTypeChanged",ANONYMOUS_CONVERTED:"anonymousConverted",ACCESS_TOKEN_REFRESHD:"refreshAccessToken"},Be={name:ft,namespace:"auth",injectEvents:{bus:_,events:[E.LOGIN_TYPE_CHANGED,E.LOGIN_STATE_EXPIRED,E.LOGIN_STATE_CHANGED,E.ACCESS_TOKEN_REFRESHD,E.ANONYMOUS_CONVERTED]},entity:function(s){if(s===void 0&&(s={region:"",persistence:"local"}),this.authInstance)return ye(N.INVALID_OPERATION,"every cloudbase instance should has only one auth object"),this.authInstance;var n=this.platform,t=n.adapter,u=n.runtime,i=s.persistence||t.primaryStorage;i&&i!==this.config.persistence&&this.updateConfig({persistence:i});var e=this.config,o=e.env,c=e.persistence,h=e.debug;return this.authInstance=new Se({env:o,region:s.region,persistence:c,debug:h,cache:this.cache,request:this.request,runtime:u}),this.authInstance}};try{cloudbase.registerComponent(Be)}catch{}function yt(s){try{s.registerComponent(Be)}catch(n){console.warn(n)}}function pt(s,n){var t=Se.prototype;t[s]=function(u){var i="_"+s;return this[i]||(this[i]=new n(g(g({},u),this._config))),this[i]}}export{pt as a,yt as r};
